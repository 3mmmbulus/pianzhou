{% set page_title = current_page.title|default(site_title) %}
{% set is_home = (current_page.id|default('')) in ['index', ''] %}
{% set full_title = is_home ? page_title : (page_title ~ ' - ' ~ site_title) %}
{% set desc = meta.description|default(meta.Description|default(pages.index.meta.description|default(''))) %}
{% set canonical = current_page.url|default(base_url ~ '/') %}
{% set robots = meta.robots|default(meta.Robots|default('')) %}

<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>{{ full_title }}</title>
  {% if desc %}<meta name="description" content="{{ desc }}">{% endif %}
  <link rel="canonical" href="{{ canonical }}">
  {% if robots %}<meta name="robots" content="{{ robots }}">{% endif %}
  <link rel="stylesheet" href="{{ theme_url }}/assets/style.css">

  {# NOTE: OG/Twitter/JSON-LD are generated by plugins; theme must not output them. #}
</head>
<body class="t-f site">
  <a class="skip-link" href="#main">跳到正文</a>

  <header class="site-header">
    <div class="container header-inner">
      <div class="brand">
        <a class="brand-link" href="{{ base_url }}/">{{ site_title }}</a>
        <span class="brand-tag">阅读视图</span>
      </div>
      <nav class="site-nav" aria-label="主导航">
        <a class="nav-link" href="{{ base_url }}/">首页</a>
        <a class="nav-link" href="{{ base_url }}/news/">新闻</a>
        {% for p in pages() %}{% if not p.hidden and p.id not in ['404','news','news/index'] %}
          <a class="nav-link" href="{{ p.url }}">{{ p.title }}</a>
        {% endif %}{% endfor %}
      </nav>
    </div>
  </header>

  <div class="container layout site-main">
    <main id="main" class="main">
      {% block main %}{% endblock %}
    </main>
    <aside class="side" aria-label="侧栏">
      <section class="panel">
        <h2 class="panel-title">站点信息</h2>
        <p class="muted">移动端优先、阅读增强。</p>
      </section>

      {# Unique block (f only): Reading checklist #}
      <section class="panel unique-f">
        <h2 class="panel-title">阅读清单</h2>
        <ul class="checklist">
          <li>看标题与摘要</li>
          <li>浏览目录/段落</li>
          <li>收藏关键结论</li>
        </ul>
      </section>
    </aside>
  </div>

  <footer class="site-footer">
    <div class="container"><small>&copy; {{ "now"|date("Y") }} {{ site_title }}</small></div>
  </footer>
</body>
</html>
