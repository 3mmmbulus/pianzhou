{% set page_title = current_page.title|default(site_title) %}
{% set is_home = (current_page.id|default('')) in ['index', ''] %}
{% set full_title = is_home ? page_title : (page_title ~ ' - ' ~ site_title) %}
{% set desc = meta.description|default(meta.Description|default(pages.index.meta.description|default(''))) %}
{% set canonical = current_page.url|default(base_url ~ '/') %}
{% set robots = meta.robots|default(meta.Robots|default('')) %}
{% set page_id = current_page.id|default('') %}
{% set is_news_index = page_id == 'news' or page_id == 'news/index' %}
{# Theme must NOT output OG/Twitter/JSON-LD; plugins do that. #}

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>{{ full_title }}</title>
{% if desc %}<meta name="description" content="{{ desc }}">{% endif %}
<link rel="canonical" href="{{ canonical }}">
{% if robots %}<meta name="robots" content="{{ robots }}">{% endif %}

<link rel="stylesheet" href="{{ theme_url }}/assets/style.css">

{% if is_news_index %}
  {% set page_num = url_param('page', 'int', 0) %}
  {% if not page_num %}{% set page_num = url_param('p', 'int', 1) %}{% endif %}
  {% if not page_num or page_num < 1 %}{% set page_num = 1 %}{% endif %}

  {% set per_page = config.PpwwcmsNewsList.per_page|default(10) %}
  {% set news_pages = pages('news', null, 1, 0) %}
  {% set total_items = 0 %}
  {% for p in news_pages %}
    {% if not p.hidden %}{% set total_items = total_items + 1 %}{% endif %}
  {% endfor %}
  {% set total_pages = (total_items / per_page)|round(0, 'ceil') %}

  {% if page_num > 1 %}<link rel="prev" href="{{ current_page.url }}?page={{ page_num - 1 }}">{% endif %}
  {% if total_pages and page_num < total_pages %}<link rel="next" href="{{ current_page.url }}?page={{ page_num + 1 }}">{% endif %}
{% endif %}

